<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 06 - Paradoxical collider effect</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Causal Inference</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Overview
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-flask"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab01.html">Lab 1</a>
    </li>
    <li>
      <a href="Lab02.html">Lab 2</a>
    </li>
    <li>
      <a href="Lab03.html">Lab 3</a>
    </li>
    <li>
      <a href="Lab04.html">Lab 4</a>
    </li>
    <li>
      <a href="Lab05.html">Lab 5</a>
    </li>
    <li>
      <a href="Lab06.html">Lab 6</a>
    </li>
    <li>
      <a href="Lab07.html">Lab 7</a>
    </li>
    <li>
      <a href="Lab08.html">Lab 8</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 06 - Paradoxical collider effect</h1>
<h3 class="subtitle">Individual assignment</h3>
<h4 class="date">Due: March 22 at 23:59</h4>

</div>


<style>
.column-left{
  float: left;
  width: 60%;
  text-align: left;
}
.column-right-small{
  float: right;
  width: 30%;
  text-align: right;
  padding-left: 10px;
  font-size:10px;
}

.column-right-large{
  float: right;
  width: 40%;
  text-align: left;
  padding-left: 10px;
}

.column-full{
  float: none;
  width: 100%;
  text-align: centre;
}


.column-full-left{
  float: none;
  width: 100%;
  text-align: left;
}

.center {
  height: 200px;
  border: 0px;
  text-align: center;
}


.RUsers {
  padding: 1em;
  background: aliceblue;
  color: black;
}


.SPSS {
  padding: 1em;
  background: whitesmoke;
  color: black;
}

</style>
<div class="column-right-large">
<p><img src="images/salt.jpg" width="500px" /></p>
</div>
<div class="column-full-left">
<ul>
<li>Please submit your lab using <a href="https://docs.google.com/forms/d/e/1FAIpQLSeWnDOKz2_2p4XQl9efCOK9PrgwSIbisFx5nBd-B6bwGa4d6w/viewform">this link</a>.<br />
</li>
<li>If you have questions, please <a href="https://bit.ly/OferMeet">book a slot</a> during Ofer’s office hours!</li>
</ul>
<p>We use Luque-Fernandez et al. (2019) example from epidemiology, to explore collider bias using a simulation. The outcome <span class="math inline">\(Y\)</span> of interest is (systolic) blood pressure. This is an important outcome because roughly 46% of Americans have high blood pressure, and high blood pressure is associated with increased risk of mortality. The “Treatment” <span class="math inline">\(T\)</span> of interest is sodium intake. Sodium intake is a continuous variable; but we will binarize <span class="math inline">\(T\)</span> by letting <span class="math inline">\(T=1\)</span> denote daily sodium intake above the mean in our sample and letting <span class="math inline">\(T=0\)</span> denote daily sodium intake below the mean. We will be estimating the causal effect of sodium intake on blood pressure.</p>
<p>In our data, we also have the age of the individuals, which acts as a confounder and amount of protein in their urine, which acts as a collider. We will replicate Luque-Fernandez et al.’s simulation, which takes care that the range of values is “biologically plausible and as close to reality as possible.”</p>
<p>Because we are using data from a simulation, we know that the true ATE of sodium on blood pressure is 1.05. More concretely, the line of code that generates blood pressure <span class="math inline">\(Y\)</span> looks as follows:</p>
<p>AGE = Age (years)<br />
SOD = 24-hour dietary sodium intake (g)<br />
PRO = 24-hour excretion of urinary protein (proteinuria) (mg)<br />
SBP = Systolic blood pressure (mmHg)<br />
</p>
<ol style="list-style-type: decimal">
<li><p>Create a directed acyclical graph (DAG) to represent our assumptions regarding the system of relationships between the four variables. <br/></p></li>
<li><p>Simulate the data given the following coefficients and the model below, to create a dataset. Plot the distributions of the variables in the dataset. <br/> <span class="math display">\[\begin{align}
X_{age} &amp;\sim \mathbb{N}(\mu=65, \sigma=5)\\
n_{obs}&amp;=1000\\
\beta_{sod2sbp}&amp;=1.05\\
\alpha_{sod2pro}&amp;=0.5\\
\alpha_{sbp2pro}&amp;=0.5\\
X_{sodium_{gr}} &amp;\sim \mathbb{N}(\mu=X_{age}/18,\sigma=1) \\
Y_{sbp} &amp;\sim \mathbb{N}(\mu=\beta_{sod2sbp}\cdot X_{sodium.bin}+  2\cdot X_{age},\sigma=1) \\
X_{pro} &amp;\sim \mathbb{N}(\mu=\alpha_{sod2pro}\cdot X_{sodium.bin}+  \alpha_{sbp2pro}\cdot X_{sbp},\sigma=1) \\
\end{align}\]</span></p></li>
</ol>
<p><br/> <br/> We now start with our data-set, and want to estimate three models, as follows:</p>
<ul>
<li>For the first model, regress the Systolic blood pressure against the sodium intake. This will be our <em>naive estimation</em>.</li>
<li>For the second model, regress the Systolic blood pressure against the sodium intake while controlling for the age and urinary protein.</li>
<li>For the third model, we regress the Systolic blood pressure against the sodium intake while controlling for the age only.</li>
</ul>
<p><br/> 3. For each of these three models, estimate the average treatment effect (ATE), by predicting two potential outcomes for each of the observations. Subtract the estimated potential outcome to find the individual level effect, <span class="math inline">\(\delta\)</span>, and average the individual level effect across all subjects.</p>
<ul>
<li>Since we simulated our data, we know what the ATE should be. We also have three estimations for the ATE, one from each model. What is the error (in percentages) for each of the three models?</li>
<li>How does the ATE compare with the estimates of the model coefficients?</li>
</ul>
<p><br/> 4. Experiment with the <a href="https://watzilei.com/shiny/collider/">colider visualization</a> and try to find out how the estimation of the ATE depends on the different models. Describe your findings. Under what conditions would the ATE appear to be negative?</p>
<div id="references" class="section level3">
<h3>References</h3>
<p>Luque-Fernandez, M. A., Schomaker, M., Redondo-Sanchez, D., Jose Sanchez Perez, M., Vaidya, A., &amp; Schnitzer, M. E. (2019). Educational Note: Paradoxical collider effect in the analysis of non-communicable disease epidemiological data: a reproducible illustration and web application. International journal of epidemiology, 48(2), 640-653.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
