<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 07 - Instruments and the backlash against windfarms</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Causal Inference</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Overview
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-flask"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab01.html">Lab 1</a>
    </li>
    <li>
      <a href="Lab02.html">Lab 2</a>
    </li>
    <li>
      <a href="Lab03.html">Lab 3</a>
    </li>
    <li>
      <a href="Lab04.html">Lab 4</a>
    </li>
    <li>
      <a href="Lab05.html">Lab 5</a>
    </li>
    <li>
      <a href="Lab06.html">Lab 6</a>
    </li>
    <li>
      <a href="Lab07.html">Lab 7</a>
    </li>
    <li>
      <a href="Lab08.html">Lab 8</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 07 - Instruments and the backlash against windfarms</h1>
<h3 class="subtitle">Individual assignment</h3>
<h4 class="date">Due: March 29 at 23:59</h4>

</div>


<style>
.column-left{
  float: left;
  width: 60%;
  text-align: left;
}
.column-right-small{
  float: right;
  width: 30%;
  text-align: right;
  padding-left: 10px;
  font-size:10px;
}

.column-right-large{
  float: right;
  width: 40%;
  text-align: left;
  padding-left: 10px;
}

.column-full{
  float: none;
  width: 100%;
  text-align: centre;
}


.column-full-left{
  float: none;
  width: 100%;
  text-align: left;
}

.center {
  height: 200px;
  border: 0px;
  text-align: center;
}


.RUsers {
  padding: 1em;
  background: aliceblue;
  color: black;
}


.SPSS {
  padding: 1em;
  background: whitesmoke;
  color: black;
}

</style>
<div class="column-full-left">
<ul>
<li>Please submit your lab using <a href="https://docs.google.com/forms/d/e/1FAIpQLSdZJEndcian0_EGO6tbwoYi-f8FalRe2JPmzVc2bcyFsq9hGw/viewform">this link</a>.<br />
</li>
<li>If you have questions, please <a href="https://bit.ly/OferMeet">book a slot</a> during Ofer’s office hours!</li>
</ul>
<div id="simulating-the-operation-of-an-instrumental-variable" class="section level3">
<h3>Simulating the operation of an instrumental variable</h3>
<div class="column-right-large">
<p><img src="images/windfarms.jpg" width="500px" /></p>
<p>Stokes (2016) uses a natural experiment to demonstrate how citizens punish incumbent governments for progressive climate policy, leading to electoral losses for the incumbent party ranging from 4 to 10%, with the effect persisting 3 km from wind turbines.</p>
</div>
<p>We will first create fake data to simulate the operation of an instrumental variable. Using <a href="http://dagitty.net/dags.html">dagitty.net</a>, create a DAG with an treatment, <span class="math inline">\(T\)</span> that links to an outcome, <span class="math inline">\(Y\)</span>. Add a confounder, <span class="math inline">\(U\)</span> with causal links to both the treatment and the outcome. Finally, add a binary instrument, <span class="math inline">\(Z\in\{0,1\}\)</span>, which links to the treatment alone.</p>
<div class="SPSS">
<p>Remember when using formulas to estimate slope and intercept, the formula would look like this: <code>Y ~ X1 +X2 + X3</code>. The first variable (Y) is ALWAYS the dependent variable (outcome variables), and the rest are the independent (causes or explanatory variables).</p>
</div>
<p>Now create fake data, simulating the data generating process represented by your DAG. You will need to specify your model. For example, consider the following model (you may choose other, perhaps more complex models):</p>
<p><span class="math display">\[
\begin{aligned}
Z &amp;\sim 
  \begin{cases}
    p=\frac{1}{2}     &amp; \text{if $z = 1$}, \\
    p=\frac{1}{2} &amp; \text{if $z = 0$}
  \end{cases}  \\
U &amp;\sim \mathcal{N}(\mu=0, \sigma=1)  \\
T &amp;\sim \mathcal{N}(\mu=\alpha_1\cdot Z +\alpha_2\cdot U, \sigma=1)  \\
Y &amp;\sim \mathcal{N}(\mu=\beta_1\cdot T+\beta_2\cdot U, \sigma=1)  \\
\end{aligned}
\]</span> 1. Now let us explore our data as follows:</p>
<ul>
<li>Add a snapshot of the DAG you created to your lab report. How would your DAG change if you had one variable, mediating between instrument and outcome, and another, confounding on instrument and outcome. Given these variables, what would you need to do in order to identify the effect of the treatment on the outcome?</li>
<li>Plot the distributions of variables of interest, and visualize the relationships between them. Assuming that the data was observed (rather than simulated), how would you know that your instrument is <em>relevant</em> and <em>valid</em>?</li>
<li>Regress the outcome <span class="math inline">\(Y\)</span> against the treatment <span class="math inline">\(T\)</span> and interpret the estimated parameters. Are the estimates biased?</li>
<li>Regress the outcome <span class="math inline">\(Y\)</span> against the treatment <span class="math inline">\(T\)</span> and <span class="math inline">\(U\)</span> and interpret the estimates. Are the estimates biased?</li>
<li>Without using the unobserved confounder <span class="math inline">\(U\)</span>, use the instrument <span class="math inline">\(Z\)</span> to produce a model with unbiased estimates of the causal effect of interest. Estimate the effect using the 2SLS approach by hand, and by using the <code>ivreg</code> function from the <strong>AER</strong> library. Note that <code>ivreg</code> formula syntax is <code>Y ~ T  | Z</code>, where <code>T</code> is treatment, and <code>Z</code> is the instrument. Compare the results of your various experiments.</li>
</ul>
</div>
<div id="replicating-stokes-2015-electoral-backlash-against-climate-policy" class="section level3">
<h3>Replicating Stokes (2015) : Electoral backlash against climate policy</h3>
<p>We will now replicate <a href="https://onlinelibrary-wiley-com.proxy-ub.rug.nl/doi/full/10.1111/ajps.12220">an article</a> in which Leah Stokes (2016) examines whether governments are punished electorally for building wind farms, a policy that mitigates climate change but may impose costs on the communities where turbines are sited. She looks at Ontario in Canada, where from 2009 the provincial government removed local communities’ rights to make planning decisions on the building of wind turbines. Instead, decision-making was centralised and turbines were imposed by the government. It chose to build turbines in places where their construction was most feasible and they would generate the most electricity. In particular, they were more likely to be sited in places with higher prevailing wind speeds. Whilst certain broad areas are in general better suited for turbines (more rural and more elevated places, and areas closer to the windy great lakes), she argues that within these broad areas wind speed varies at random at the local level. This means that local communities could not select out of (or into) receiving a wind farm based on their levels of support for the policy or for the government. This is therefore a natural experiment where wind speed is an instrument that randomly encouraged the government to site turbines in particular places.</p>
<p>Her outcome of interest is change in support for the incumbent government from 2007 (before the wind farm policy) to 2011 (after it began) at a highly localised level known as “precincts” in Canada, which typically contain around 300 voters. Using GIS software, she geo-located all wind turbines that were built or proposed in the period and matched them to precincts, where she collected voting data, localised prevailing wind speeds, and background covariates. The dataset for this question can be downloaded <a href="https://bit.ly/3iuPSOw">here.</a> It contains the following variables:</p>
<table>
<colgroup>
<col width="42%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>chng_lib</td>
<td>outcome: pp change in support for the incumbent government, 2007-11</td>
</tr>
<tr class="even">
<td>prop_3km</td>
<td>treatment: =1 if a wind turbine was built or proposed within 3km, 0 otherwise</td>
</tr>
<tr class="odd">
<td>avg_pwr_log</td>
<td>instrument: prevailing wind speed in the precinct, logged</td>
</tr>
<tr class="even">
<td>longitude</td>
<td>of the precinct</td>
</tr>
<tr class="odd">
<td>latitude</td>
<td>of the precinct</td>
</tr>
<tr class="even">
<td>ed_id</td>
<td>the broader district within which the precinct is located</td>
</tr>
<tr class="odd">
<td>mindistlake</td>
<td>distance to the great lakes in km</td>
</tr>
<tr class="even">
<td>mindistlake sq</td>
<td>distance to the great lakes in km, squared</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li><p>Using data visualization, investigate the distribution of variables of interest, and the relationship between them. Create a DAG as a theoretical model, representing the system, and include it in your report. Does the data suggest that the instrument is relevant and valid? Justify your claim.</p></li>
<li><p>Assess whether wind speed can be considered to be as-if randomly assigned geographically, by regressing the instrument on all of the geographical covariates. What do you conclude? Is that problematic in terms of relevance or validity of the instrument?</p></li>
</ol>
<div class="SPSS">
<p><em>Code Hint:</em> Remember to use factor() for the <code>ed_id</code> variable. Because this is a designation of the precinct (like a district), it is a categorical variable, so estimating the model would involve automatic creation of dummy variables. Each dummy variable is associated with one precinct, and the estimated coefficient tells us the relationship between the precinct and the average wind speed in that precinct.</p>
</div>
</div>
</div>
<div class="column-right-small">
<p><img src="images/2sls.jpg" width="500px" /></p>
<p>The first and second stage of the 2SLS process, as it is described in this week’s reading (week 7: instrumental variables)</p>
</div>
<div class="column-full-left">
<ol start="4" style="list-style-type: decimal">
<li><p>Estimate the first-stage relationship between treatment and the instrument using a regression with no added covariates. Interpret the result precisely, and comment on whether you think it might be biased and if so, why.</p></li>
<li><p>Stokes actually estimates the first and second stages with a full set of geographic controls included. Why do you think she does this?</p></li>
<li><p>Estimate the first-stage relationship between the treatment and the instrument using a regression, this time with a full set of geographic controls. Interpret the result, and compare to your answer to question 4 and to Stokes’ estimate of the first stage.</p></li>
<li><p>Estimate the (Local) Average Treatment Effect of the treatment on the outcome using two-stage least squares (2SLS) with <code>avg_pwr_log</code> as the instrument and the full set of geographic controls. Interpret the coeffcient on the treatment and its statistical significance precisely. Compare your result to Stokes’ estimate in the second stage.</p></li>
</ol>
</div>
<div class="column-right-small">
<p><img src="images/stokestable2.jpg" width="500px" /></p>
<p>You will find Stoke’s estimates of the first and second stage in table 2 of the article.</p>
</div>
<div class="column-full-left">
<div class="SPSS">
<p><em>Code Hints:</em> For the 2SLS estimation, you can use ivreg() from the AER library. Your code should take the form:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ivreg</span>(outcome <span class="sc">~</span> treatment <span class="sc">+</span> covariates <span class="sc">|</span> instrument <span class="sc">+</span> covariates)</span></code></pre></div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
